<div align="center">

# ğŸ›¡ï¸ SOC Toolkit

```
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—     â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•    â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â•šâ•â•â–ˆâ–ˆâ•”â•â•â•
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘            â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   
â•šâ•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘            â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—       â–ˆâ–ˆâ•‘   â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   
â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â•  â•šâ•â•â•â•â•â•       â•šâ•â•    â•šâ•â•â•â•â•â•  â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•šâ•â•   â•šâ•â•   
```

### SOC Analyst Workbench - All-in-One IOC Analysis Tool

[![Python 3.8+](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/downloads/)
[![License: MIT](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)
[![Providers](https://img.shields.io/badge/providers-22-orange.svg)](#-providers)
[![Version](https://img.shields.io/badge/version-2.0.0-brightgreen.svg)](#)

**ğŸ” 22 Threat Intel Sources | ğŸ¯ MITRE ATT&CK | ğŸ“‚ IOC Extraction | âš¡ Parallel Queries**

</div>

---

## âœ¨ Features

- ğŸ” **22 Intel Sources** - Query threat intelligence providers in parallel
- ğŸ¯ **MITRE ATT&CK** - Map IOCs to ATT&CK techniques automatically
- ğŸ“‚ **IOC Extraction** - Extract IOCs from log files (firewall, syslog, IDS)
- ğŸ”„ **Interactive Mode** - Continuous analysis session
- ğŸ“‹ **WHOIS & DNS** - Domain/IP enrichment
- âš¡ **Parallel Queries** - 10x faster with concurrent API calls
- ğŸ’¾ **Smart Caching** - Cache results to reduce API calls
- ğŸ“Š **Multiple Exports** - JSON, Markdown, CSV formats

---

## ğŸš€ Installation

```bash
pip install soc-toolkit

# Or from source
git clone https://github.com/frkndncr/soc-toolkit.git
cd soc-toolkit
pip install -e .

soc --version
```

## ğŸ—‘ï¸ Uninstall

```bash
pip uninstall soc-toolkit
rm -rf ~/.soc-toolkit  # Remove config/cache (optional)
```

---

## ğŸ’¡ Usage

```bash
# Basic lookup
soc 185.220.101.45                      # IP
soc evil-domain.com                      # Domain
soc 44d88612fea8a8f36de82e1278abb02f    # Hash

# MITRE ATT&CK Mapping
soc 185.220.101.45 --mitre              # Show ATT&CK techniques

# Enrichment
soc evil.com --whois                    # WHOIS lookup
soc evil.com --dns                      # DNS records
soc evil.com --enrich                   # Full enrichment (WHOIS + DNS)

# IOC Extraction
soc -e /var/log/firewall.log            # Extract IOCs from log
soc -e access.log --analyze             # Extract + analyze

# Interactive Mode
soc -i

# Batch & Export
soc -f iocs.txt -o ./reports/
soc 1.2.3.4 --json out.json
soc 1.2.3.4 --md report.md
```

---

## ğŸ”Œ Providers (22 Total)

### âœ… Free - No API Key Required (10)

| Provider | Types | Description |
|----------|-------|-------------|
| Shodan InternetDB | IP | Open ports, vulnerabilities |
| IP-API | IP | GeoIP, ISP, proxy detection |
| GreyNoise | IP | Internet scanner detection |
| Pulsedive | IP, Domain, URL | Community threat intel |
| Maltiverse | IP, Domain, URL, Hash | IOC classification |
| StopForumSpam | IP, Email | Spam database |
| URLScan.io | URL, Domain | URL analysis |
| IPInfo | IP | GeoIP information |
| ThreatCrowd | IP, Domain, Email | Open threat intel |
| CIRCL Hashlookup | Hash | Known file database |

### ğŸ”‘ Premium - Free API Key Available (12)

| Provider | Types | Free Tier | Get Key |
|----------|-------|-----------|---------|
| VirusTotal | All | 500/day | [virustotal.com](https://virustotal.com) |
| AbuseIPDB | IP | 1000/day | [abuseipdb.com](https://abuseipdb.com) |
| HybridAnalysis | Hash | 200/day | [hybrid-analysis.com](https://hybrid-analysis.com) |
| Censys | IP, Domain | 250/day | [censys.io](https://censys.io) |
| AlienVault OTX | All | Unlimited | [otx.alienvault.com](https://otx.alienvault.com) |
| ThreatFox | IP, Domain, Hash | Unlimited | [auth.abuse.ch](https://auth.abuse.ch) |
| URLHaus | URL, Domain, IP | Unlimited | [auth.abuse.ch](https://auth.abuse.ch) |
| MalwareBazaar | Hash | Unlimited | [auth.abuse.ch](https://auth.abuse.ch) |
| BinaryEdge | IP, Domain | 250/month | [binaryedge.io](https://binaryedge.io) |
| CriminalIP | IP, Domain | 100/day | [criminalip.io](https://criminalip.io) |
| IPQualityScore | IP, Email | 5000/month | [ipqualityscore.com](https://ipqualityscore.com) |

> âš ï¸ **Note:** abuse.ch services (ThreatFox, URLHaus, MalwareBazaar) require a free API key since May 2025. Get one key for all services at [auth.abuse.ch](https://auth.abuse.ch)

---

## ğŸ”‘ API Keys Configuration

```bash
# Set via environment variables
export VIRUSTOTAL_API_KEY="your-key"
export ABUSEIPDB_API_KEY="your-key"
export OTX_API_KEY="your-key"
export HYBRID_ANALYSIS_API_KEY="your-key"

# abuse.ch services (single key for all)
export THREATFOX_API_KEY="your-abuse-ch-key"
export URLHAUS_API_KEY="your-abuse-ch-key"
export MALWAREBAZAAR_API_KEY="your-abuse-ch-key"
```

Or create `~/.soc-toolkit/config.ini`:

```ini
[api_keys]
virustotal = your-key
abuseipdb = your-key
otx = your-key
threatfox = your-abuse-ch-key
```

---

## ğŸ¯ MITRE ATT&CK Mapping

```bash
soc 185.220.101.45 --mitre
```

Output:
```
ğŸ¯ MITRE ATT&CK Mapping

  ğŸ“Œ Credential Access
    ğŸ”´ T1110: Brute Force

  ğŸ“Œ Command and Control
    ğŸŸ¡ T1071: Application Layer Protocol

  ğŸ“Œ Initial Access
    ğŸŸ¢ T1190: Exploit Public-Facing Application
```

---

## ğŸ“Š Example Output

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ ğŸ” IOC: 185.220.101.45                                       â•‘
â•‘ ğŸ“‹ Type: IP                                                  â•‘
â•‘ ğŸ”´ CRITICAL - Known malicious indicator!                     â•‘
â•‘ ğŸ“Š Found in 8/22 sources | âš ï¸  3 sources flagged as malicious â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Source      â”‚ Status   â”‚ Threat   â”‚ Details                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Maltiverse  â”‚ âœ… Found â”‚ ğŸ”´ Crit  â”‚ classification: malicio â”‚
â”‚ GreyNoise   â”‚ âœ… Found â”‚ ğŸ”µ Low   â”‚ classification: suspici â”‚
â”‚ Shodan      â”‚ âœ… Found â”‚ ğŸ”µ Low   â”‚ ports: 80, 443          â”‚
â”‚ IP-API      â”‚ âœ… Found â”‚ ğŸŸ¢ Clean â”‚ country: Germany        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ§ª Testing

```bash
chmod +x test_soc.sh
./test_soc.sh
```

---

## ğŸ“ Changelog

### v2.0.0 (December 2025)
- ğŸ”„ Updated all providers to latest APIs
- â• Added 3 new providers (CIRCL, CriminalIP, IPQualityScore)
- âš ï¸ abuse.ch services now require free API key
- ğŸ¯ MITRE ATT&CK mapping
- ğŸ“‹ WHOIS & DNS enrichment
- ğŸ› Fixed deprecated API endpoints

### v1.2.0
- Added MITRE ATT&CK mapping
- Added WHOIS/DNS enrichment
- 19 providers

---

## ğŸ‘¨â€ğŸ’» Author

**Furkan DinÃ§er** - [@frkndncr](https://github.com/frkndncr)

## ğŸ“„ License

MIT License
